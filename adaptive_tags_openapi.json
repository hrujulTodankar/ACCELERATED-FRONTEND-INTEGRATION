{"openapi":"3.1.0","info":{"title":"Adaptive Tagging Service","version":"1.0"},"paths":{"/ingest/analytics":{"post":{"summary":"Ingest Analytics","description":"Ingest analytics payloads from /bhiv/analytics.\nMap analytics -> reward -> update thresholds -> call RL service.","operationId":"ingest_analytics_ingest_analytics_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalyticsPayload"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/healthz":{"get":{"summary":"Healthz","operationId":"healthz_healthz_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/thresholds":{"get":{"summary":"Thresholds","operationId":"thresholds_thresholds_get","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AnalyticsPayload":{"properties":{"item_id":{"type":"string","title":"Item Id"},"timestamp":{"type":"string","title":"Timestamp"},"tags":{"items":{"$ref":"#/components/schemas/TagMetric"},"type":"array","title":"Tags"}},"type":"object","required":["item_id","timestamp","tags"],"title":"AnalyticsPayload"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status"},"last_update_ts":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Update Ts"},"tag_count":{"type":"integer","title":"Tag Count"},"sample_adaptations":{"additionalProperties":{"type":"number"},"type":"object","title":"Sample Adaptations"}},"type":"object","required":["status","last_update_ts","tag_count","sample_adaptations"],"title":"HealthResponse"},"TagMetric":{"properties":{"tag":{"type":"string","title":"Tag"},"predicted_confidence":{"type":"number","title":"Predicted Confidence"},"ctr":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Ctr"},"approvals":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Approvals"},"rejections":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rejections"},"samples":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Samples"}},"type":"object","required":["tag","predicted_confidence"],"title":"TagMetric"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}